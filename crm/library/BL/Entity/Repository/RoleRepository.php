<?php

namespace BL\Entity\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * RoleRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class RoleRepository extends EntityRepository {

    public function get_all_roles($params=array()) {
        $q = $this->_em->createQuery('SELECT r.id FROM BL\Entity\Role r');
        //echo $q->getDQL();
        //echo $q->getSQL();
        $u = $q->execute(); //$roles;
        $u2 = array();
        $i = 0;
        foreach ($u as $u1) {
            foreach($u1 as $v){
                $u2[$i++] = $v;
            }
        }
        $this->_em->clear();
        return $u2;
    }

    public function get_roles_list($params=array()) {
        $q = $this->_em->createQuery('SELECT r.id,r.role_name FROM BL\Entity\Role r');
        //echo $q->getDQL();
        //echo $q->getSQL();
        $u = $q->getArrayResult(); //$roles;
        return $u;
    }

    public function get_current_roles($user_id) {
        $q = $this->_em->createQuery("SELECT u, ur FROM BL\Entity\User u LEFT JOIN u.roles ur where u.id='" . $user_id . "'");
        return $q->getArrayResult();
    }

    public function get_role_id ($role_name="client") {
        $q = $this->_em->createQuery("SELECT r.id FROM BL\Entity\Role r where r.role_name='".$role_name."'");
        $role = $q->execute();
        return $role;
    }
}